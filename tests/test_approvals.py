import pytest
from app.models.user import UserRole
from app.core.security import create_access_token

@pytest.mark.asyncio
async def test_approvals_list_all_as_admin(client):
    # Generate Admin Token Correctly
    admin_token = create_access_token(subject="admin_id", data={"role": "admin"})
    headers = {"Authorization": f"Bearer {admin_token}"}

    res = await client.get("/api/approvals/all", headers=headers)
    assert res.status_code == 200

@pytest.mark.asyncio
async def test_approvals_unauthorized(client):
    res = await client.get("/api/approvals/all")
    assert res.status_code == 401